{% extends "base.html" %}
{% block content %}
<h1>Tasks</h1>

<p><a class="btn btn-primary" href="{% url 'tasks:create' %}">Create task</a></p>

<form method="get" class="row g-2 align-items-end mb-3">
  <div class="col-sm-3">
    <label for="id_status" class="form-label">Status</label>
    {{ filter.form.status }}
  </div>

  <div class="col-sm-3">
    <label for="id_executor" class="form-label">Executor</label>
    {{ filter.form.executor }}
  </div>

  <div class="col-sm-3">
    <label for="id_label" class="form-label">Label</label>
    {{ filter.form.label }}
  </div>

  <div class="col-sm-3">
    <div class="form-check mt-4">
      {{ filter.form.self_tasks }}
      <label class="form-check-label" for="{{ filter.form.self_tasks.id_for_label }}">
        Only my tasks
      </label>
    </div>
  </div>

  <div class="col-12">
    <button type="submit" class="btn btn-primary">Show</button>
  </div>
</form>

<table class="table table-striped align-middle">
  <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Status</th>
      <th>Author</th>
      <th>Executor</th>
      <th>Created at</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  {% for t in tasks %}
    <tr>
      <td>{{ t.id }}</td>
      <td><a href="{% url 'tasks:detail' t.pk %}">{{ t.name }}</a></td>
      <td>{{ t.status }}</td>
      <td>{{ t.author.get_full_name|default:t.author.username }}</td>
      <td>
      {% if t.executor %}
      {{ t.executor.get_full_name|default:t.executor.username }}
      {% else %}
      â€”
      {% endif %}
      </td>
      <td>{{ t.created_at|date:"d.m.Y H:i" }}</td>
      <td class="text-end">
        <a class="btn btn-sm btn-outline-secondary" href="{% url 'tasks:update' t.pk %}">Update</a>
        <a class="btn btn-sm btn-outline-danger" href="{% url 'tasks:delete' t.pk %}">Delete</a>
      </td>
    </tr>
  {% empty %}
    <tr><td colspan="7">No tasks yet.</td></tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
